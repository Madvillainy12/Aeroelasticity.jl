<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>- · Aeroelasticity.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Aeroelasticity.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../guide/">Getting Started</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>-</a><ul class="internal"><li><a class="tocitem" href="#section-stability"><span>Aeroelastic Analysis of a Typical Section</span></a></li></ul></li><li><a class="tocitem" href="../section-simulation/">-</a></li></ul></li><li><span class="tocitem">Model Documentation</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Aerodynamic Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../models/aerodynamics/steady/">Steady Thin Airfoil Theory</a></li><li><a class="tocitem" href="../../models/aerodynamics/quasisteady/">Quasi-Steady Thin Airfoil Theory</a></li><li><a class="tocitem" href="../../models/aerodynamics/wagner/">Wagner&#39;s Function</a></li><li><a class="tocitem" href="../../models/aerodynamics/peters/">Peters&#39; Finite State</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Structural Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../models/structures/section/">Typical Section</a></li><li><a class="tocitem" href="../../models/structures/gxbeam/">Geometrically Exact Beam Theory</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Coupled Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../models/couplings/steady-section/">Steady Thin Airfoil Theory + Typical Section</a></li><li><a class="tocitem" href="../../models/couplings/quasisteady-section/">Quasi-Steady Thin Airfoil Theory + Typical Section</a></li><li><a class="tocitem" href="../../models/couplings/wagner-section/">Wagner&#39;s Function + Typical Section</a></li><li><a class="tocitem" href="../../models/couplings/peters-section/">Peters&#39; Finite State + Typical Section</a></li></ul></li></ul></li><li><a class="tocitem" href="../../developer/">Developer Guide</a></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../../reference/public/">Public</a></li><li><a class="tocitem" href="../../reference/internals/">Internals</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>-</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>-</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/byuflowlab/Aeroelasticity.jl/blob/main/docs/src/literate/section-stability.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h2 id="section-stability"><a class="docs-heading-anchor" href="#section-stability">Aeroelastic Analysis of a Typical Section</a><a id="section-stability-1"></a><a class="docs-heading-anchor-permalink" href="#section-stability" title="Permalink"></a></h2><p>In this example, we perform a two-dimensional aeroelastic analysis for a two degree of freedom typical section model.</p><p><img src="../../assets/section-drawing.svg" alt/></p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>This example is also available as a Jupyter notebook: <a href="https://nbviewer.jupyter.org/github/byuflowlab/Aeroelasticity.jl/blob/gh-pages/dev/examples/section-stability.ipynb"><code>section-stability.ipynb</code></a>.</p></div></div><p>The equations of motion for this model are</p><p class="math-container">\[m \left(\ddot{h}+b x_\theta \ddot{\theta} \right) + k_h h = -L \\
I_\theta \ddot{\theta} + m b x_\theta \ddot{h} + k_\theta = M\]</p><p>where <span>$b$</span> is the semichord length, <span>$k_h$</span> is the linear spring constant, <span>$k_\theta$</span> is the torsional spring constant, <span>$m$</span> is the mass per unit span, <span>$x_\theta$</span> is the distance to the center of mass from the reference point, <span>$I_θ$</span> is the moment of inertia about the reference point, <span>$L$</span> is the lift per unit span, and <span>$M$</span> is the moment per unit span about the reference point.  To learn more about how this model is implemented in this package, see <a href="../../models/structures/section/#Aeroelasticity.Section"><code>Section</code></a>.</p><p>This package has a number of pre-implemented aerodynamic models which may be used to model the aerodynamics of the typical section model.  These models include a steady-state thin airfoil theory model (see <a href="../../models/aerodynamics/steady/#Aeroelasticity.Steady"><code>Steady</code></a>), a quasi-steady thin airfoil theory model (see <a href="../../models/aerodynamics/quasisteady/#Aeroelasticity.QuasiSteady"><code>QuasiSteady</code></a>), an unsteady aerodynamic model based on Wagner&#39;s function (see <a href="../../models/aerodynamics/wagner/#Aeroelasticity.Wagner"><code>Wagner</code></a>), and Peters&#39; finite state aerodynamic model (see <a href="../../models/aerodynamics/peters/#Aeroelasticity.Peters"><code>Peters</code></a>).  We will perform aeroelastic analyses using each of these models and compare the results.</p><p>The non-dimensional parameters we will use are</p><p class="math-container">\[a = -1/5 \quad e = -1/10  \\
r^2 = \frac{I_P}{m b^2} \quad \sigma = \frac{\omega_h}{\omega_\theta} \\
\mu = \frac{m}{\rho_\infty \pi b^2} \quad V = \frac{U}{b \omega_\theta}\]</p><p>where <span>$a$</span> is the normalized distance from the semichord to the reference point, <span>$e$</span> is the normalized distance from the semichord to the center of mass, and <span>$\omega_h$</span> and <span>$\omega_\theta$</span> are the uncoupled natural frequencies, defined as</p><p class="math-container">\[\omega_h = \sqrt{\frac{k_h}{m}} \quad \omega_\theta = \sqrt{\frac{k_\theta}{I_P}}\]</p><pre><code class="language-julia hljs">using Aeroelasticity, DifferentialEquations, LinearAlgebra

# define non-dimensional parameters
V = range(1e-6, 3.1, length=1000) # = U/(b*ωθ) (reduced velocity)
a = -1/5 # reference point normalized location
e = -1/10 # center of mass normalized location
μ = 20 # = m/(ρ*pi*b^2) (mass ratio)
r2 = 6/25 # = Iθ/(m*b^2) (radius of gyration about P)
σ = 2/5 # = ωh/ωθ (natural frequency ratio)
xθ = e - a # distance from center of mass to reference point
a0 = 2*pi # lift curve slope
α0 = 0 # zero lift angle
cd0 = 0 # drag coefficient
cm0 = 0 # moment coefficient

# choose dimensional parameters
b = 1 # semichord
ρ = 1 # air density
ωθ = 1 # pitch natural frequency
c = 343 # air speed of sound

# calculate dimensionalized parameters
U = V*b*ωθ # freestrean velocity
m = μ*ρ*pi*b^2 # mass
Sθ = m*xθ*b # mass imbalance
Iθ = r2*m*b^2 # inertia
ωh = σ*ωθ # plunge natural frequency
kh = m*ωh^2 # plunge spring constant
kθ = Iθ*ωθ^2 # pitch spring constant

# define aerodynamic models
aerodynamic_models = (Steady(), QuasiSteady(), Wagner(), Peters{6}())

# initialize eigenvalue/eigenvector storage
λ = Vector{Matrix{ComplexF64}}(undef, length(aerodynamic_models))
Uλ = Vector{Array{ComplexF64,3}}(undef, length(aerodynamic_models))
Vλ = Vector{Array{ComplexF64,3}}(undef, length(aerodynamic_models))

# perform an analysis for each aerodynamic model
for imodel = 1:length(aerodynamic_models)

    # define coupled model
    model = assemble_model(;
        aerodynamic_model = aerodynamic_models[imodel],
        structural_model = Section())

    # define ODE function
    f = ODEFunction(model)

    # eigenvalue/eigenvector storage
    nλ = number_of_states(model)
    λ[imodel] = zeros(ComplexF64, nλ, length(V))
    Uλ[imodel] = zeros(ComplexF64, nλ, nλ, length(V))
    Vλ[imodel] = zeros(ComplexF64, nλ, nλ, length(V))

    # loop through each reduced frequency
    for i = 1:length(V)

        # define aerodynamic parameters
        aerodynamic_parameters = (; a = a, b = b, a0 = a0, alpha0 = α0, cd0 = cd0, cm0 = cm0)

        # define structural parameters
        structural_parameters = (; kh = kh, ktheta = kθ, m = m, Stheta = Sθ, Itheta = Iθ)

        # define additional parameters
        additional_parameters = (; U = U[i], rho = ρ, c = c)

        # define parameter vector
        p = assemble_parameters(model;
            aerodynamic_parameters = aerodynamic_parameters,
            structural_parameters = structural_parameters,
            additional_parameters = additional_parameters)

        # define initial guess for equilibrium states
        x0 = assemble_states(model)

        # find equilibrium point
        x = solve(SteadyStateProblem(f, x0, p))

        # linearize about equilibrium point
        K, M = linearize(model, x, p)

        # perform linear stability analysis
        λi, Uλi, Vλi = get_eigen(model, K, M)

        # correlate eigenvalues
        if i &gt; 1
            # previous left eigenvector matrix
            Uλpi = Uλ[imodel][:,:,i-1]

            # use correlation matrix to correlate eigenmodes
            perm, corruption = correlate_eigenmodes(Uλpi, M, Vλi)

            # re-arrange eigenmodes
            λi = λi[perm]
            Uλi = Uλi[perm,:]
            Vλi = Vλi[:,perm]
        end

        # save eigenvalues/eigenvectors
        λ[imodel][:,i] = λi
        Uλ[imodel][:,:,i] = Uλi
        Vλ[imodel][:,:,i] = Vλi
    end
end</code></pre><p>We now plot the results for each aerodynamic model.</p><pre><code class="language-julia hljs">using Plots
pyplot()

sp1 = plot(
    title = &quot;Non-Dimensional Frequency&quot;,
    xlim = (0,3.1),
    xtick = 0.0:0.5:3.0,
    xlabel = &quot;\$ \\frac{U}{b \\omega_\\theta} \$&quot;,
    ylim = (0, 1.05),
    ytick = 0.0:0.2:1.0,
    ylabel = &quot;\$ \\frac{\\Omega}{\\omega_\\theta} \$&quot;,
    titlefontsize = 10,
    guidefontsize = 10,
    legendfontsize = 8,
    tickfontsize = 9,
    foreground_color_legend = nothing,
    background_color_legend = nothing,
    minorgrid=false
    )

sp2 = plot(
    title = &quot;Non-Dimensional Damping&quot;,
    xlim = (0,3.1),
    xtick = 0.0:0.5:3.0,
    xlabel = &quot;\$ \\frac{U}{b \\omega_\\theta} \$&quot;,
    ylim = (-0.7, 0.605),
    ytick = -0.6:0.2:0.6,
    ylabel = &quot;\$ \\frac{Γ}{\\omega_\\theta} \$&quot;,
    framestyle = :zerolines,
    titlefontsize = 10,
    guidefontsize = 10,
    legendfontsize = 8,
    tickfontsize = 9,
    legend = :topleft,
    foreground_color_legend = nothing,
    background_color_legend = nothing,
    minorgrid = false
    )

labels = [&quot;Steady&quot;, &quot;Quasi-Steady&quot;, &quot;Wagner&quot;, &quot;Peters (N=6)&quot;]

for ia = 1:length(aerodynamic_models)

    plot!(sp1, V, imag.(λ[ia][1,:])/ωθ,
        label = labels[ia],
        color = ia,
        markersize = 1,
        markerstrokewidth = 0,
        )

    for i = 2:size(λ[ia], 1)
        plot!(sp1, V, imag.(λ[ia][i,:])/ωθ,
            label = &quot;&quot;,
            color = ia,
            markersize = 1,
            markerstrokewidth = 0,
            )
    end

    plot!(sp2, V, real.(λ[ia][1,:])/ωθ,
        label = labels[ia],
        color = ia,
        markersize = 1,
        markerstrokewidth = 0,
        )

    for i = 2:size(λ[ia], 1)
        plot!(sp2, V, real.(λ[ia][i,:])/ωθ,
            label = &quot;&quot;,
            color = ia,
            markersize = 1,
            markerstrokewidth = 0,
            )
    end
end

p1 = plot(sp1, sp2, layout = (1, 2), size = (800, 300))</code></pre><p><img src="../../assets/section-stability.svg" alt/></p><p>Using the <code>Wagner</code> or <code>Peters</code> aerodynamic models yields a flutter reduced velocity around 2.2, while the <code>Steady</code> and <code>QuasiSteady</code> aerodynamic models predict significantly lower flutter velocities.  The aerodynamic state variables of the <code>Wagner</code> and <code>Peters</code> models allows these models to capture the impact of vortex shedding on the lift and drag of the profile, therefore we can expect these models to yield more accurate results than the <code>Steady</code> and <code>QuasiSteady</code> models.</p><p>The non-dimensional parameters we use for this example match those used by Hodges and Pierce in &quot;Introduction to Structural Dynamics and Aeroelasticity&quot;.  Hodges and Pierce performed the analysis using a steady-state model and Peter&#39;s finite state model with six state variables.   The results presented here for the steady-state and Peters&#39; finite state models match the results presented by Hodges and Pierce in &quot;Introduction to Structural Dynamics and Aeroelasticity&quot;, which validates our implementation of these models.  Additionally, since the flutter speed predicted by the <code>Wagner</code> and <code>Peters</code> models match, we can be reasonably confident that the Wagner unsteady aerodynamic model is also implemented correctly.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../guide/">« Getting Started</a><a class="docs-footer-nextpage" href="../section-simulation/">- »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.14 on <span class="colophon-date" title="Monday 14 March 2022 20:53">Monday 14 March 2022</span>. Using Julia version 1.6.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
